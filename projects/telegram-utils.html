<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Utils - Riccardo Marino</title>
    <link rel="stylesheet" href="../css/project.css">
</head>
<body>
    <nav class="back-nav">
        <a href="../index.html" class="back-link">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
            Back to Portfolio
        </a>
    </nav>
    
    <article class="project-detail">
        <header class="project-header">
            <h1>Telegram Utils</h1>
            <p class="subtitle">Surgical Telegram Account Cleanup</p>
            <div class="project-meta">
                <a href="https://github.com/rmfalco89/telegram-utils" target="_blank" class="github-link">
                    View on GitHub
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                        <polyline points="15 3 21 3 21 9"></polyline>
                        <line x1="10" y1="14" x2="21" y2="3"></line>
                    </svg>
                </a>
                <div class="tech-stack">
                    <span class="tech-tag">Python</span>
                    <span class="tech-tag">Telethon</span>
                    <span class="tech-tag">MTProto</span>
                    <span class="tech-tag">asyncio</span>
                </div>
            </div>
        </header>
        
        <section class="content-section">
            <h2>The Problem</h2>
            <p>Telegram's official clients are optimized for messaging, not account maintenance. Common cleanup tasks become painful:</p>
            <ul>
                <li><strong>Contact bloat:</strong> Telegram syncs your entire phone contact book. Removing hundreds of contacts means tapping each one individually.</li>
                <li><strong>Chat spam:</strong> Every time a contact joins Telegram, you get a service message chat. These pile up into dozens of meaningless conversations.</li>
                <li><strong>No bulk actions:</strong> The UI doesn't provide batch operations for these scenarios.</li>
            </ul>
            <p>This repo solves these annoyances with two focused Python scripts that use Telegram's MTProto API to perform bulk deletions safely.</p>
        </section>
        
        <section class="content-section">
            <h2>Why MTProto?</h2>
            <p>The scripts use <strong>Telethon</strong>, a pure-Python MTProto client, instead of the Bot API. Key advantages:</p>
            <ul class="highlights-list">
                <li><strong>User account access:</strong> Bot API can't manage contacts or personal dialogs</li>
                <li><strong>Full API surface:</strong> Direct access to <code>contacts.deleteContacts</code>, <code>messages.deleteHistory</code></li>
                <li><strong>No bot middleman:</strong> Operates as your account, not through a separate bot entity</li>
            </ul>
        </section>
        
        <section class="content-section">
            <h2>Features</h2>
            
            <div class="feature-card">
                <h3>delete_contacts.py — Contact List Purge</h3>
                <p>Core functionality:</p>
                <ul>
                    <li><strong>Access hash validation:</strong> Only processes contacts with valid <code>access_hash</code></li>
                    <li><strong>Batch processing:</strong> Deletes in chunks of 100 to respect rate limits</li>
                    <li><strong>Preview before destruction:</strong> Shows first 5 contacts, requires explicit <code>DELETE</code> confirmation</li>
                    <li><strong>Progress reporting:</strong> Live count during deletion (Deleted 250/847)</li>
                </ul>
            </div>
            
            <div class="feature-card">
                <h3>delete_chats.py — Dialog Cleanup with Modes</h3>
                <p><strong>Three operational modes:</strong></p>
                <ul>
                    <li><strong>Default (joined):</strong> Deletes "joined Telegram" service messages + near-empty chats</li>
                    <li><strong>--empty-only:</strong> Any chat with ≤1 message gets deleted</li>
                    <li><strong>--all:</strong> Nuclear option—deletes everything including groups/channels</li>
                </ul>
                <p><strong>Detection logic for "joined" chats:</strong></p>
                <p>Pattern-matches Telegram's internal service message type for contact sign-ups. More reliable than string matching on message text.</p>
            </div>
        </section>
        
        <section class="content-section">
            <h2>Safety & UX Design</h2>
            <p>Both scripts implement a <strong>progressive disclosure</strong> safety model:</p>
            
            <div class="feature-card">
                <h3>1. Preview → Confirm → Execute</h3>
                <div class="code-block">
                    <pre>
Found 847 contacts.

Preview (first 5):
  1. Alice Smith (@alice)
  2. Bob Jones (no username)
  ...

⚠️  WARNING: This will delete ALL 847 contacts!
Type 'DELETE' to confirm: _
                    </pre>
                </div>
                <p>The <code>DELETE</code> confirmation requirement forces a moment of reflection before destructive operations.</p>
            </div>
            
            <div class="feature-card">
                <h3>2. Graceful Failure Handling</h3>
                <p>Errors don't abort the entire run. The script logs failures and continues, then summarizes errors at the end. This prevents one API hiccup from blocking cleanup of 500+ chats.</p>
            </div>
            
            <div class="feature-card">
                <h3>3. Informative Progress</h3>
                <div class="code-block">
                    <pre>
Deleting 127 chats...
  ✓ Deleted: John Doe joined Telegram (1/127)
  ✓ Deleted: Empty Chat (2/127)
  ✗ Failed: Group XYZ - FloodWaitError
  ...
                    </pre>
                </div>
                <p>Real-time feedback with visual indicators (✓/✗) makes long-running operations less opaque.</p>
            </div>
        </section>
        
        <section class="content-section">
            <h2>Authentication Flow</h2>
            <div class="code-block">
                <pre>
client = TelegramClient(SESSION_NAME, API_ID, API_HASH)
await client.start(phone=phone)
                </pre>
            </div>
            <p><strong>Session persistence</strong> is handled elegantly:</p>
            <ul>
                <li>First run: phone → 2FA code → local <code>.session</code> file created</li>
                <li>Subsequent runs: <code>.session</code> file reused, no re-authentication</li>
                <li>Security: Session files are equivalent to auth tokens—kept local, never shared</li>
            </ul>
        </section>
        
        <section class="content-section">
            <h2>Usage</h2>
            <p><strong>Setup:</strong></p>
            <div class="code-block">
                <pre>
git clone git@github.com:rmfalco89/telegram-utils.git
cd telegram-utils
pip install -r requirements.txt

# Get API credentials from https://my.telegram.org/apps
export TELEGRAM_API_ID="your_id"
export TELEGRAM_API_HASH="your_hash"
                </pre>
            </div>
            
            <p><strong>Delete all contacts:</strong></p>
            <div class="code-block">
                <pre>
python delete_contacts.py
                </pre>
            </div>
            
            <p><strong>Delete "joined Telegram" chats:</strong></p>
            <div class="code-block">
                <pre>
python delete_chats.py
                </pre>
            </div>
            
            <p><strong>Nuclear option (careful!):</strong></p>
            <div class="code-block">
                <pre>
python delete_chats.py --all
                </pre>
            </div>
        </section>
        
        <section class="content-section">
            <h2>Use Cases</h2>
            <p>Who benefits from this?</p>
            <ul class="highlights-list">
                <li><strong>Privacy-conscious users:</strong> Clear Telegram's auto-synced contact list after disabling sync permissions</li>
                <li><strong>Account hoarders:</strong> People with 500+ "joined Telegram" chats who don't want to tap "Delete" for an hour</li>
                <li><strong>Fresh-start seekers:</strong> Nuke all chats when switching to a new Telegram account workflow</li>
                <li><strong>Developers:</strong> Reference implementation for Telethon-based account automation</li>
            </ul>
        </section>
        
        <section class="content-section">
            <h2>Code Quality</h2>
            <p><strong>Strengths:</strong></p>
            <ul class="highlights-list">
                <li><strong>Documentation-first approach:</strong> Comprehensive docstrings, README with troubleshooting</li>
                <li><strong>Error messages guide users:</strong> <code>Get credentials from: https://my.telegram.org/apps</code> appears in error output</li>
                <li><strong>CLI flexibility:</strong> Phone number can be passed as arg or prompted interactively</li>
                <li><strong>Minimal dependencies:</strong> Just <code>telethon>=1.42.0</code>, no bloat</li>
            </ul>
        </section>
        
        <section class="content-section">
            <h2>Technical Takeaways</h2>
            
            <div class="feature-card">
                <h3>1. Telethon's Async Model is Clean</h3>
                <p>The library fully embraces Python's async/await. No callbacks, no threading complexity. The API feels natural for I/O-bound operations.</p>
            </div>
            
            <div class="feature-card">
                <h3>2. MTProto Type System is Strict</h3>
                <p>You can't just pass a <code>User</code> object to <code>DeleteContactsRequest</code>. You need <code>InputUser</code>. This adds boilerplate but prevents subtle bugs from mismatched entity types.</p>
            </div>
            
            <div class="feature-card">
                <h3>3. Session Management is Opaque but Reliable</h3>
                <p>The <code>.session</code> file format is SQLite-based but encrypted. Telethon handles all the complexity: stores auth keys, server salts, datacenter IPs, persists entity cache, and auto-migrates between library versions.</p>
            </div>
        </section>
        
        <section class="content-section">
            <h2>Why This Code Matters</h2>
            <p><code>telegram-utils</code> is a masterclass in <strong>focused utility design</strong>:</p>
            <ul class="highlights-list">
                <li><strong>Solves a real problem</strong> — Addresses actual pain points, not hypothetical use cases</li>
                <li><strong>Safe by default</strong> — Preview, confirm, batch, handle errors gracefully</li>
                <li><strong>Well-documented</strong> — README covers setup, usage, troubleshooting, and API references</li>
                <li><strong>Minimal surface area</strong> — Two scripts, one dependency, no framework bloat</li>
                <li><strong>Teachable codebase</strong> — Clean async patterns, good variable names, logical flow</li>
            </ul>
            <p>Sometimes the best code is boring code that just works. <code>telegram-utils</code> doesn't introduce novel algorithms or showcase cutting-edge frameworks. It wraps Telegram's API in a safety harness and gets out of your way.</p>
        </section>
    </article>
</body>
</html>
